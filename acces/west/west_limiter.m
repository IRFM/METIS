function [r,z] = west_limiter(shot)

if nargin == 1
  try
      [r,z] = Paroi_WEST(shot);
      r(end + 1) = r(1);
      z(end + 1) = z(1);
  catch
      first_wall = fullfile(fileparts(which('westmetissimulation.m')),'west_wall.mat');
      fw = load(first_wall);
      r = fw.R;
      z = fw.Z;
  end
else
      first_wall = fullfile(fileparts(which('westmetissimulation.m')),'west_wall.mat');
      fw = load(first_wall);
      r = fw.R;
      z = fw.Z;
end

function [r,z] = west_limiter_fixed

% debut mur
rz_mur = [
    3.119513000000000e+000   -2.791968000000000e-002
    3.118051000000000e+000   -5.580511000000000e-002
    3.115617000000000e+000   -8.362292000000000e-002
    3.112214000000000e+000   -1.113381000000000e-001
    3.107846000000000e+000   -1.389184000000000e-001
    3.102518000000000e+000   -1.663290000000000e-001
    3.096237000000000e+000   -1.935374000000000e-001
    3.089009000000000e+000   -2.205100000000000e-001
    3.080845000000000e+000   -2.472136000000000e-001
    3.071754000000000e+000   -2.736163000000000e-001
    3.061747000000000e+000   -2.996849000000000e-001
    3.050836000000000e+000   -3.253892000000000e-001
    3.039035000000000e+000   -3.506967000000000e-001
    3.026358000000000e+000   -3.755772000000000e-001
    3.012820000000000e+000   -3.999998000000000e-001
    2.998438000000000e+000   -4.239354000000000e-001
    2.983230000000000e+000   -4.473545000000000e-001
    2.967213000000000e+000   -4.702283000000000e-001
    2.78565      	     -0.67200
    2.38000      	     -0.67200
    2.36674      	     -0.76077
    1.96155      	     -0.59707
    1.89650      	     -0.55635
    1.87373      	     -0.44236
    1.85605      	     -0.33195
    1.84371      	     -0.22102
    1.83632      	     -0.10950
    1.83392      	      0.00209
    1.83651      	      0.11382
    1.84408      	      0.22518
    1.85663      	      0.33623
    1.87411      	      0.44647
    1.88630      	      0.55690
    1.90083      	      0.57303
    2.45725      	      0.79782
    2.46000      	      0.75
    2.77	              0.75
    2.8			      0.79
    3.026358000000000e+000    6.400000000000000e-001
    3.026358000000000e+000    3.755773000000000e-001
    3.039035000000000e+000    3.506969000000000e-001
    3.050836000000000e+000    3.253893000000000e-001
    3.061747000000000e+000    2.996853000000000e-001
    3.071754000000000e+000    2.736161000000000e-001
    3.080845000000000e+000    2.472136000000000e-001
    3.089009000000000e+000    2.205099000000000e-001
    3.096237000000000e+000    1.935375000000000e-001
    3.102518000000000e+000    1.663294000000000e-001
    3.107846000000000e+000    1.389185000000000e-001
    3.112214000000000e+000    1.113385000000000e-001
    3.115618000000000e+000    8.362277999999999e-002
    3.118051000000000e+000    5.580518000000000e-002
    3.119513000000000e+000    2.791960000000000e-002
    3.120000000000000e+000                         0
    
    ];
r = rz_mur(:,1);
z = rz_mur(:,2);

function [Rparoi,Zparoi] = Paroi_WEST(Nch)
%
% function Paroi_WEST.m
% =====================
%
% This function define the limiter coordinates (R,Z)
% This program uses the mat file WEST_Geom_From_xls.mat created by
% MAKE_Geom_From_xls2.m
%
% USAGE: [Rparoi,Zparoi] = Paroi_WEST(Nch);
%   Input:
%      Nch shot number
%
% Ph. Moreau Version 0 du 06/02/2017
%


PosLPA = tsmat(Nch,'EXP=T=S;Position;PosLPA');% PosLPA = 3.2
load('WEST_Geom_From_xls.mat');
Rparoi = Geom.Limiter_Convex.R;
Zparoi = Geom.Limiter_Convex.Z;
IdxLPA = 1:26;
dR = -max(Rparoi(IdxLPA)) + PosLPA;
Rparoi(IdxLPA) = Rparoi(IdxLPA) + dR;
