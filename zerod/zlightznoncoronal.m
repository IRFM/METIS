% input:
% te = electron temperature in eV
% ne = electron density in m^-3
% tau_resid = impurity residence time in s
% elem      = name of element
%
% output:
% Lz in W/m^3
% return NaN outside validity intervalle

function [Lz,Z_ave] = zlightznoncoronal(te,ne,tau_resid,elem)

% from reference:
%Radiative Cooling Rates for Low-Z Impurities in Non-coronal Equilibrium State
%A. A. Mavrin , J Fusion Energ, DOI 10.1007/s10894-017-0136-z
X = log10(te);
% saturation of theeffect under 1e16
Y = log10(max(1e16,ne .* tau_resid) ./ 1e19);

% conversion
if isnumeric(elem)
  elem = sprintf('%d',elem);
end

switch elem
% data section
case {'He','2'}
        %Helium: coefficients for polynomial fits to radiative cooling rate LZ
        tmin_lz = [1,3,10,30,100];
        tmax_lz = [3,10,30,100,15000];
        A0_lz   = [-3.9341e+01,-2.7185e+01,-3.4950e+01,-3.1299e+01,-3.3203e+01];
        A1_lz   = [2.2742e+01,-3.4465e+01,5.5957e+00,-4.4749e+00,-2.3306e+00];
        A2_lz   = [-8.5940e-02,3.2223e-01,2.1542e+00,2.9614e-01,-5.3911e-01];
        A3_lz   = [-2.5420e+01,5.0933e+01,-7.4762e+00,1.5259e+00,7.2592e-01];
        A4_lz   = [1.8843e+00,1.0589e-01,-3.7391e+00,-6.1433e-01,9.7550e-02];
        A5_lz   = [-3.5681e-01,1.1632e-01,1.4444e-01,3.2651e-01,2.6917e-01];
        A6_lz   = [-3.2771e+00,-2.3641e+01,2.4534e+00,-1.6652e-01,-6.6110e-02];
        A7_lz   = [-4.9766e+00,-7.4782e-01,1.5000e+00,1.5704e-01,8.9900e-03];
        A8_lz   = [1.9730e-02,-7.6200e-03,2.1307e-01,-8.0601e-04,2.9240e-02];
        A9_lz   = [-7.4260e-02,2.1030e-02,7.6590e-02,5.0330e-02,5.1180e-02];

        %Helium: coefficients for polynomial fits to mean charge ⟨Z⟩
        tmin_z    =[1,3,10,30,100,1000];
        tmax_z    =[3,10,30,100,1000,15000];
        A0_z      =[-5.3229e+00,2.9480e-01,-7.5801e-01,1.2390e-01,2.8742e-01,3.0230e-01];
        A1_z      =[2.3974e+01,-9.7749e-01,2.6057e+00,3.3522e-01,1.9520e-02,-3.7672e-04];
        A2_z      =[-2.0820e-02,7.1838e-01,3.9868e-01,6.2830e-02,1.1370e-02,8.0700e-03];
        A3_z      =[-2.5859e+01,4.6087e-01,-2.1295e+00,-2.1004e-01,-9.0900e-03,-6.6674e-05];
        A4_z      =[1.5630e+00,-2.5075e+00,-7.0155e-01,-8.6750e-02,-8.9400e-03,-2.6500e-03];
        A5_z      =[-2.7940e-01,-2.2053e-01,-7.8740e-02,-1.2890e-02,9.3167e-04,4.6700e-03];
        A6_z      =[-2.2304e+00,5.7576e-01,5.7676e-01,4.3490e-02,1.3700e-03,1.9595e-05];
        A7_z      =[-4.3071e+00,1.9437e+00,3.0493e-01,2.9910e-02,1.9700e-03,2.4019e-04];
        A8_z      =[1.0620e-02,2.7694e-01,7.2220e-02,1.0680e-02,5.7310e-04,-5.7766e-04];
        A9_z      =[-2.3440e-02,1.3210e-02,7.6100e-03,2.2200e-03,8.8833e-04,9.7854e-04];

        
case {'Li','3'}
        %Lithium: coefficients for polynomial fits to radiative cooling rate LZ
        tmin_lz = [1,7,30,60,100,1000];
        tmax_lz = [7,30,60,100,1000,10000];
        A0_lz      =[-3.5752e+01,-3.1170e+01,-3.6558e+01,-3.0560e+01,-3.0040e+01,-3.4199e+01];
        A1_lz      =[-1.6780e+00,-1.6918e+01,9.4272e+00,-2.4680e+00,-4.2963e+00,-8.5686e-01];
        A2_lz      =[9.5500e-03,1.1481e-01,3.5299e+00,1.7912e+00,2.7407e-01,-6.3246e-01];
        A3_lz      =[-6.1560e+00,2.0492e+01,-8.1056e+00,-2.8659e-01,1.1569e+00,2.4968e-01];
        A4_lz      =[-1.5027e+00,2.6136e-01,-4.4113e+00,-1.9929e+00,-4.5453e-01,9.9930e-02];
        A5_lz      =[2.5568e-01,2.4870e-01,5.1430e-02,2.8150e-01,3.0616e-01,2.5080e-01];
        A6_lz      =[1.1009e+01,-7.0035e+00,1.9427e+00,2.3898e-01,-9.1510e-02,-1.7230e-02];
        A7_lz      =[2.1169e+00,-3.3910e-01,1.3459e+00,5.0412e-01,9.7550e-02,1.4410e-02];
        A8_lz      =[-9.6420e-02,-3.5570e-02,2.3865e-01,5.8550e-02,1.6540e-02,3.7030e-02];
        A9_lz      =[1.3460e-02,4.1910e-02,8.6850e-02,6.7410e-02,5.4690e-02,5.5670e-02];


        %Lithium: coefficients for polynomial fits to mean charge ⟨Z⟩
        tmin_z = [1,7,30,60,100,1000];
        tmax_z = [7,30,60,100,1000,10000];
        A0_z      =[-1.0100e-03,-2.0635e+00,-1.0637e+00,-4.0067e-01,3.7673e-01,4.7538e-01];
        A1_z      =[2.7249e-01,4.3288e+00,2.6510e+00,1.4848e+00,1.3675e-01,2.8900e-03];
        A2_z      =[-1.7260e-02,-2.8654e-01,2.8874e-01,3.0008e-01,5.2880e-02,1.5530e-02];
        A3_z      =[-1.2369e+00,-2.3837e+00,-1.5162e+00,-8.3674e-01,-6.1300e-02,-1.1900e-03];
        A4_z      =[-8.1530e-02,6.6065e-01,-3.5040e-01,-3.5714e-01,-4.9940e-02,-5.3100e-03];
        A5_z      =[-1.3690e-02,1.3410e-02,-5.4230e-02,-4.7950e-02,-7.7600e-03,8.9900e-03];
        A6_z      =[1.3026e+00,4.1307e-01,2.8809e-01,1.5698e-01,9.0100e-03,1.4464e-04];
        A7_z      =[1.9173e-01,-3.4624e-01,1.0889e-01,1.0760e-01,1.1850e-02,5.7357e-04];
        A8_z      =[1.0850e-02,-4.9130e-02,4.1090e-02,3.3880e-02,5.7100e-03,-8.2221e-04];
        A9_z      =[-2.4500e-03,-6.1700e-03,8.1200e-03,6.4300e-03,2.7100e-03,2.2800e-03];

case {'Be','4'}
        %Beryllium: coefficients for polynomial fits to radiative cooling rate LZ
        tmin_lz = [0.2,0.7,3,11,45,170];
        tmax_lz = [0.7,3,11,45,170,10000];
        A0_lz      =[-3.0242e+01,-3.2152e+01,-3.0169e+01,-3.7201e+01,-4.0868e+01,-2.8539e+01];
        A1_lz      =[2.1405e+01,3.1572e+00,-8.9830e+00,-2.5643e+00,1.4625e+01,-5.0020e+00];
        A2_lz      =[1.0117e-01,1.4168e-01,6.3656e-01,-4.0467e+00,3.3373e+00,3.1089e-01];
        A3_lz      =[2.7450e+01,-1.4617e+01,4.5232e+00,7.1732e+00,-8.8128e+00,1.3149e+00];
        A4_lz      =[8.8367e-01,1.4646e-01,-1.5126e+00,5.8147e+00,-3.1064e+00,-4.0022e-01];
        A5_lz      =[-6.6110e-02,1.4683e-01,4.0756e-01,4.0114e-01,2.4343e-01,3.1788e-01];
        A6_lz      =[3.0202e+01,4.3653e+00,-3.7497e-01,-2.5926e+00,1.5996e+00,-1.0780e-01];
        A7_lz      =[1.2175e+00,-1.1290e+00,7.2552e-01,-2.0708e+00,6.8069e-01,7.3280e-02];
        A8_lz      =[-1.4883e-01,3.4914e-01,-2.9810e-02,-1.4775e-01,6.0120e-02,1.7320e-02];
        A9_lz      =[4.8900e-03,4.1730e-02,5.5620e-02,2.1900e-02,6.8350e-02,6.1360e-02];

        %Beryllium: coefficients for polynomial fits to mean charge ⟨Z⟩
        tmin_z = [1.2,4.5,18,70,270,1050];
        tmax_z = [4.5,18,70,270,1050,10000];
        A0_z      =[-1.4344e-01,1.6730e-02,1.0467e+00,-5.1970e-01,3.9007e-01,5.4416e-01];
        A1_z      =[2.0962e+00,1.2580e+00,-2.6102e+00,1.5563e+00,2.5938e-01,5.8290e-02];
        A2_z      =[-4.8170e-02,1.1149e-01,-3.6741e-01,2.7329e-01,1.1357e-01,6.8610e-02];
        A3_z      =[-2.5849e+00,-1.7967e+00,2.4758e+00,-7.1881e-01,-1.0490e-01,-1.8950e-02];
        A4_z      =[4.0719e-01,-3.3248e-01,5.9571e-01,-2.6616e-01,-8.7250e-02,-3.0430e-02];
        A5_z      =[-1.2800e-03,-1.9620e-02,4.7160e-02,-4.0450e-02,-4.3300e-03,2.2080e-02];
        A6_z      =[5.7597e-01,8.2415e-01,-6.4727e-01,1.1044e-01,1.4010e-02,2.0000e-03];
        A7_z      =[-5.4392e-01,2.2028e-01,-2.2861e-01,6.5560e-02,1.7660e-02,3.7000e-03];
        A8_z      =[1.7140e-02,1.5680e-02,-4.7890e-02,2.4220e-02,6.0200e-03,-2.9000e-03];
        A9_z      =[4.9000e-03,-1.0200e-03,-2.9700e-03,6.5700e-03,4.6900e-03,4.5900e-03];

case {'C','6'}
        %Carbon: coefficients for polynomial fits to radiative cooling rate LZ
        tmin_lz = [1,7,20,70,200,700];
        tmax_lz = [7,20,70,200,700,15000];
        A0_lz      =[-3.4509e+01,-4.9228e+01,-1.9100e+01,-6.7743e+01,-2.4016e+01,-2.8126e+01];
        A1_lz      =[6.7599e+00,5.3922e+01,-1.5476e+01,4.1606e+01,-7.3974e+00,-4.1679e+00];
        A2_lz      =[-1.7140e-02,8.4584e-01,4.2962e+00,-5.3665e+00,2.9707e+00,4.9937e-01];
        A3_lz      =[-4.0337e+00,-5.1128e+01,2.1893e+00,-1.5734e+01,1.6859e+00,9.0578e-01];
        A4_lz      =[1.5517e-01,-8.9366e-01,-6.1658e+00,6.1760e+00,-2.1965e+00,-5.3687e-01];
        A5_lz      =[2.1110e-02,-2.2710e-02,1.6098e-01,7.8010e-01,3.0521e-01,2.5962e-01];
        A6_lz      =[6.5977e-01,1.4758e+01,1.1021e+00,1.7905e+00,-1.1147e-01,-5.8310e-02];
        A7_lz      =[-1.7392e-01,1.6371e-01,2.1568e+00,-1.7320e+00,3.8653e-01,1.0420e-01];
        A8_lz      =[-2.9270e-02,2.9362e-01,1.1101e-01,-2.7897e-01,3.8970e-02,4.6610e-02];
        A9_lz      =[1.7600e-03,5.5880e-02,4.2700e-02,2.3450e-02,7.8690e-02,7.3950e-02];

        %Carbon: coefficients for polynomial fits to mean charge ⟨Z⟩
        tmin_z = [1,3,10,30,100,300];
        tmax_z = [3,10,30,100,300,15000];
        A0_z      =[-1.7799e-01,6.8333e-01,-1.3092e+00,1.7808e+00,-4.7139e+00,4.1877e-01];
        A1_z      =[2.4465e+00,-2.0893e+00,4.1883e+00,-1.3260e+00,6.0788e+00,3.4803e-01];
        A2_z      =[1.8370e-02,1.4225e-01,1.1598e-01,5.1150e-01,-5.7445e-01,1.3581e-01];
        A3_z      =[-1.2305e+01,3.0963e+00,-3.0465e+00,2.3885e-01,-2.1878e+00,-1.1064e-01];
        A4_z      =[-1.2788e+00,-4.8037e-01,-1.8574e-01,-6.8025e-01,6.2149e-01,-8.0230e-02];
        A5_z      =[-7.4430e-02,-3.0240e-02,-3.5430e-02,-2.3040e-02,5.3540e-02,3.0200e-03];
        A6_z      =[1.9589e+01,-1.1135e+00,7.3542e-01,8.0050e-02,2.5342e-01,1.1530e-02];
        A7_z      =[3.3268e+00,3.5170e-01,7.5470e-02,2.1915e-01,-1.6397e-01,1.2450e-02];
        A8_z      =[3.2173e-01,2.1640e-02,3.2500e-02,6.5800e-03,-3.4550e-02,3.8400e-03];
        A9_z      =[1.7020e-02,2.2200e-03,4.7400e-03,-1.6500e-03,-1.8900e-03,6.9500e-03];

case {'N','7'}
        %Nitrogen: coefficients for polynomial fits to radiative cooling rate LZ
        tmin_lz = [1,10,30,100,300,1000];
        tmax_lz = [10,30,100,300,1000,15000];
        A0_lz      =[-3.5312e+01,-5.8692e+01,-2.0301e+01,-7.7571e+01,-2.9401e+01,-2.7201e+01];
        A1_lz      =[7.1926e+00,6.8148e+01,-8.8594e+00,5.0488e+01,-3.8191e-01,-4.4640e+00];
        A2_lz      =[7.8200e-03,3.6209e-01,6.0500e+00,-6.5889e+00,3.5270e+00,7.6960e-01];
        A3_lz      =[-3.5696e+00,-5.4257e+01,-2.7129e+00,-1.8187e+01,-1.0347e+00,9.2450e-01];
        A4_lz      =[-1.2800e-02,1.4835e-01,-7.6700e+00,6.8691e+00,-2.4192e+00,-6.7720e-01];
        A5_lz      =[1.1180e-02,-1.4700e-03,1.0705e-01,8.3119e-01,3.2269e-01,2.6185e-01];
        A6_lz      =[3.5812e-01,1.3476e+01,1.9691e+00,2.0259e+00,2.2501e-01,-5.6280e-02];
        A7_lz      =[-2.5100e-03,-2.9646e-01,2.3943e+00,-1.7572e+00,3.9511e-01,1.2014e-01];
        A8_lz      =[-2.2020e-02,2.2706e-01,1.4088e-01,-2.9376e-01,2.6510e-02,4.6870e-02];
        A9_lz      =[-1.0000e-03,5.4220e-02,4.7450e-02,1.7200e-02,7.8930e-02,7.9250e-02];

        %Nitrogen: coefficients for polynomial fits to mean charge ⟨Z⟩
        tmin_z = [1,3,10,30,100,300];
        tmax_z = [3,10,30,100,300,15000];
        A0_z      =[-6.0730e-01,-1.2360e-01,-3.0201e+00,-1.1575e+00,5.3055e+00,2.4555e-01];
        A1_z      =[6.7436e+00,-1.5013e-01,6.8387e+00,3.5522e+00,-7.4489e+00,5.4906e-01];
        A2_z      =[5.0880e-02,-2.8270e-02,-4.3181e-01,3.4654e-01,-8.8428e-01,1.5955e-01];
        A3_z      =[-2.4611e+01,1.9528e+00,-4.0233e+00,-2.2595e+00,3.8373e+00,-1.6552e-01];
        A4_z      =[-1.4903e+00,1.7398e-01,7.3774e-01,-4.5913e-01,8.1585e-01,-8.8320e-02];
        A5_z      =[-1.4348e-01,8.3300e-03,-1.3120e-02,-4.0940e-02,4.0670e-02,4.7500e-03];
        A6_z      =[2.8891e+01,-1.1502e+00,7.4141e-01,4.7727e-01,-6.2886e-01,1.6410e-02];
        A7_z      =[3.3994e+00,-1.7399e-01,-3.0713e-01,1.5000e-01,-1.8832e-01,1.2450e-02];
        A8_z      =[4.0640e-01,-2.5930e-02,1.0370e-02,2.8510e-02,-2.9740e-02,1.8300e-03];
        A9_z      =[1.0090e-02,2.9700e-03,5.1100e-03,3.9800e-03,-4.0400e-03,6.1600e-03];
        
case {'O','8'}
        %Oxygen: coefficients for polynomial fits to radiative cooling rate LZ
        tmin_lz = [1,10,30,100,300,1000];
        tmax_lz = [10,30,100,300,1000,15000];
        A0_lz      =[-3.6208e+01,-2.9057e+01,-2.9370e+01,-4.4120e-02,-3.7073e+01,-2.5037e+01];
        A1_lz      =[7.5487e+00,-1.5228e+01,8.7451e+00,-5.4918e+01,7.8826e+00,-5.7568e+00];
        A2_lz      =[2.3340e-02,-3.1460e+00,6.3827e+00,-9.5003e+00,3.7999e+00,1.2973e+00];
        A3_lz      =[-2.1983e+00,2.0826e+01,-1.2357e+01,2.8883e+01,-3.8006e+00,1.2040e+00];
        A4_lz      =[-1.0131e-01,5.9427e+00,-7.6451e+00,8.5536e+00,-2.2619e+00,-9.1955e-01];
        A5_lz      =[8.0600e-03,1.0610e-01,-2.2230e-02,5.5336e-01,5.0270e-01,2.8988e-01];
        A6_lz      =[-6.5108e-01,-8.0843e+00,3.4958e+00,-4.8731e+00,5.2144e-01,-7.6780e-02];
        A7_lz      =[8.4570e-02,-2.6827e+00,2.2661e+00,-1.9172e+00,3.0219e-01,1.4568e-01];
        A8_lz      =[-2.1710e-02,1.0350e-02,2.5727e-01,-1.5709e-01,-6.6330e-02,3.9250e-02];
        A9_lz      =[-2.1200e-03,2.6480e-02,7.7800e-02,1.6370e-02,6.1140e-02,8.3010e-02];

        %Oxygen: coefficients for polynomial fits to mean charge ⟨Z⟩
        tmin_z = [1,3,10,30,100,1000];
        tmax_z = [3,10,30,100,1000,15000];
        A0_z      =[-9.5815e-01,-1.0843e+00,1.5515e+00,-8.7537e-01,2.0410e+00,5.1222e-01];
        A1_z      =[8.6060e+00,3.4193e+00,-4.0874e+00,2.8142e+00,-2.0842e+00,3.3703e-01];
        A2_z      =[1.8810e-02,-1.8379e-01,-1.4906e-01,3.1564e-01,-3.0970e-01,1.3422e-01];
        A3_z      =[-2.3986e+01,-2.4888e+00,4.3356e+00,-1.5982e+00,1.0431e+00,-9.6270e-02];
        A4_z      =[-4.0039e-01,6.2117e-01,2.1524e-01,-3.8355e-01,2.7360e-01,-6.6430e-02];
        A5_z      =[-1.3987e-01,8.6902e-04,-1.7110e-02,-4.9410e-02,2.9410e-02,1.5250e-02];
        A6_z      =[2.1422e+01,6.4064e-01,-1.3034e+00,3.0260e-01,-1.5838e-01,9.1000e-03];
        A7_z      =[7.8251e-01,-4.7287e-01,-7.5070e-02,1.1692e-01,-5.8890e-02,8.7200e-03];
        A8_z      =[3.7189e-01,-2.3400e-02,9.4000e-03,3.3890e-02,-1.5170e-02,-7.5344e-05];
        A9_z      =[1.6820e-02,2.3400e-03,4.7200e-03,6.0200e-03,6.8667e-04,7.5400e-03];


case {'Ne','10'}
        %Neon: coefficients for polynomial fits to radiative cooling rate LZ
        tmin_lz = [1,10,70,300,1000,3000];
        tmax_lz = [10,70,300,1000,3000,15000];
        A0_lz      =[-3.8610e+01,-3.6822e+01,-6.6901e+00,-1.1261e+02,-2.6330e+02,-1.1174e+02];
        A1_lz      =[1.2606e+01,4.9706e+00,-2.4212e+01,8.5765e+01,2.1673e+02,6.1907e+01];
        A2_lz      =[1.7866e-01,-1.5334e+00,7.3589e+00,-2.1093e+00,1.2973e+00,4.7967e+00];
        A3_lz      =[-1.0213e+01,1.1973e+00,5.7352e+00,-3.0372e+01,-6.7799e+01,-1.6289e+01];
        A4_lz      =[-7.7051e-01,2.7279e+00,-7.4602e+00,2.2928e+00,-7.3310e-01,-2.5731e+00];
        A5_lz      =[2.7510e-02,9.0090e-02,-7.9030e-02,7.7055e-01,4.4883e-01,4.2620e-01];
        A6_lz      =[4.3390e+00,-1.3992e+00,-8.5020e-02,3.5346e+00,7.0398e+00,1.4263e+00];
        A7_lz      =[6.4207e-01,-1.1084e+00,1.8679e+00,-5.6062e-01,9.3190e-02,3.3443e-01];
        A8_lz      =[-3.3560e-02,1.3620e-02,2.2507e-01,-1.8569e-01,-1.5390e-02,-9.3734e-04];
        A9_lz      =[-1.3333e-04,2.4300e-02,7.1420e-02,3.7550e-02,7.7660e-02,8.4220e-02];

        %Neon: coefficients for polynomial fits to mean charge ⟨Z⟩
        tmin_z = [1,3,30,150,700,3000];
        tmax_z = [3,30,150,700,3000,10000];
        A0_z      =[-3.3816e+00,-6.0381e-01,-5.2745e+00,5.7405e+00,4.2006e+00,1.4412e+01];
        A1_z      =[2.1546e+01,2.1443e+00,8.5325e+00,-5.8032e+00,-3.1864e+00,-1.0957e+01];
        A2_z      =[5.2790e-02,1.5187e-01,-4.2933e-01,1.9982e-01,5.2700e-02,-1.0029e+00];
        A3_z      =[-3.8551e+01,-1.6424e+00,-3.8758e+00,2.2647e+00,1.0504e+00,2.9793e+00];
        A4_z      =[1.1151e+00,-3.7364e-01,5.0111e-01,-2.0411e-01,-2.7000e-03,5.7614e-01];
        A5_z      =[-2.5719e-01,-3.7110e-02,-9.4400e-03,-1.7610e-02,1.5710e-02,9.1900e-02];
        A6_z      =[1.7595e+01,5.5371e-01,5.7791e-01,-2.8482e-01,-1.1477e-01,-2.6962e-01];
        A7_z      =[-3.7001e+00,2.1255e-01,-1.4192e-01,4.9800e-02,-4.5800e-03,-8.1250e-02];
        A8_z      =[1.5688e-01,4.6390e-02,7.0900e-03,6.6500e-03,-6.1200e-03,-1.9450e-02];
        A9_z      =[-1.5480e-02,1.0360e-02,6.2200e-03,2.9600e-03,3.3500e-03,1.0250e-02];


case {'Ar','18'}
        %Argon: coefficients for polynomial fits to radiative cooling rate LZ
        tmin_lz = [1,10,50,150,500,1500];
        tmax_lz = [10,50,150,500,1500,10000];
        A0_lz      =[-3.6586e+01,-4.8732e+01,-2.3157e+01,-6.8134e+01,5.5851e+01,-6.2758e+01];
        A1_lz      =[1.2841e+01,3.8185e+01,-8.5132e+00,3.6408e+01,-7.8618e+01,2.5163e+01];
        A2_lz      =[2.3080e-02,-7.0622e-01,1.5617e+00,-7.3868e+00,1.0520e+01,-7.4717e-01];
        A3_lz      =[-1.2087e+01,-2.5859e+01,1.5478e+00,-1.0735e+01,2.2871e+01,-6.8170e+00];
        A4_lz      =[-9.8000e-03,1.2850e+00,-1.8880e+00,6.8800e+00,-7.7061e+00,6.9486e-01];
        A5_lz      =[-2.4600e-03,-6.8710e-02,2.2830e-01,3.1142e-01,-1.8530e-01,4.6946e-01];
        A6_lz      =[4.8823e+00,5.4372e+00,2.8279e-01,8.0440e-01,-2.1616e+00,5.9969e-01];
        A7_lz      =[-3.7470e-02,-5.2157e-01,5.5767e-01,-1.5740e+00,1.4123e+00,-1.3487e-01];
        A8_lz      =[1.1100e-03,1.4016e-01,-9.9600e-02,-9.9180e-02,1.8409e-01,-8.1380e-02];
        A9_lz      =[1.1100e-03,1.9120e-02,-1.5280e-02,9.4500e-03,6.7470e-02,2.5840e-02];

        %Argon: coefficients for polynomial fits to mean charge ⟨Z⟩
        tmin_z = [1,3,30,150,800,3000];
        tmax_z = [3,30,150,800,3000,15000];
        A0_z      =[-1.6479e+00,-3.7000e-02,-2.1815e+00,3.4440e-01,-6.2298e-01,-5.5980e-02];
        A1_z      =[1.7269e+01,8.4654e-01,5.6525e+00,-8.8102e-01,1.9143e+00,8.4358e-01];
        A2_z      =[6.3469e-01,1.9686e-01,5.8842e-01,-8.2562e-01,6.0335e-01,4.9210e-02];
        A3_z      =[-5.4795e+01,-4.4897e-01,-3.4723e+00,9.6778e-01,-6.7700e-01,-1.7924e-01];
        A4_z      =[-2.5512e+00,-4.2059e-01,-6.6826e-01,6.8899e-01,-3.9229e-01,-8.8500e-03];
        A5_z      =[-1.1689e-01,-2.7020e-02,-1.9050e-02,4.1560e-02,-5.5500e-03,3.9240e-02];
        A6_z      =[5.6009e+01,2.0570e-01,7.1256e-01,-1.9402e-01,8.0610e-02,1.2520e-02];
        A7_z      =[1.6808e+00,2.0050e-01,1.8688e-01,-1.4218e-01,6.4780e-02,-3.1010e-04];
        A8_z      =[5.7200e-03,1.4660e-02,1.2050e-02,-1.9050e-02,7.1000e-03,-8.0800e-03];
        A9_z      =[-2.3900e-03,3.2500e-03,4.7000e-03,4.4500e-03,1.0420e-02,8.6000e-03];

otherwise
       fprintf('C%s',elem);
       Lz = NaN * ones(size(ne));
       Z_ave = NaN * ones(size(ne));
       return
end

% output
% sso   = size(te);
Lz    = NaN * ones(size(te));
Z_ave = NaN * ones(size(te));
% computation of Lz
% loop on temperature intervalle
for k=1:length(tmin_lz)
    indi = find((te >= tmin_lz(k)) & (te <= tmax_lz(k)));
    Lz(indi) = 10 .^ polyxy(X(indi),Y(indi),A0_lz(k),A1_lz(k),A2_lz(k),A3_lz(k),A4_lz(k),A5_lz(k),A6_lz(k),A7_lz(k),A8_lz(k),A9_lz(k));
end
% computation of <Z>
% loop on temperature intervalle
for k=1:length(tmin_lz)
    indi = find((te >= tmin_z(k)) & (te <= tmax_z(k)));
    Z_ave(indi) = 10 .^ polyxy(X(indi),Y(indi),A0_z(k),A1_z(k),A2_z(k),A3_z(k),A4_z(k),A5_z(k),A6_z(k),A7_z(k),A8_z(k),A9_z(k));
end

% test residence time validity 
% above must me substitued by equilibrium value
Lz(((ne .* tau_resid) > 1e19))    = NaN;
Z_ave(((ne .* tau_resid) > 1e19)) = NaN;



function F = polyxy(X,Y,A0,A1,A2,A3,A4,A5,A6,A7,A8,A9)

F = A0 + A1 .* X + A2 .* Y + A3 .* X .^ 2 + A4 .* X .* Y + ...
    A5 .* Y .^ 2 + A6 .* X .^ 3 + A7 .* X .^ 2 .* Y + A8 .* X .* Y .^ 2 + A9 .* Y .^ 3;
    
    


    




