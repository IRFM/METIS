function Fast_external_icrh(post)

time = post.profil0d.temps;
x    = post.profil0d.xli;
rho  = post.profil0d.rmx;

picrh_el  = zeros(length(time),size(rho,2));
picrh_fw  = zeros(length(time),size(rho,2));
picrh_ion = zeros(length(time),size(rho,2));
jfwcd     = zeros(length(time),size(rho,2));

for k=1:length(time)
	t=time(k);
	% time selection
	if t < 8
		out = fisrt;
	elseif t < 10
		out = second;
	else
		out = third;
	end
	rho_t  = rho(k,:) ./ rho(k,end);
	% data separtion
	rho_out  = out(:,1)';
	pout_ion = out(:,2)';
	pout_el  = out(:,3)'; 
	pout_fw  = out(:,4)';
	%
	% flux coordinate to Lao coordinate
	%	
	picrh_ion(k,:) = pchip(rho_out,pout_ion,rho_t);
	picrh_el(k,:)  = pchip(rho_out,pout_el,rho_t);
	picrh_fw(k,:)  = pchip(rho_out,pout_fw,rho_t);
end

% creating data structure for external data
ICRH_SHAPE_EXP.temps   =  time;
ICRH_SHAPE_EXP.x       =  x;
ICRH_SHAPE_EXP.jfwcd   =  jfwcd;
ICRH_SHAPE_EXP.pel     =  picrh_el  .* 1e6;
ICRH_SHAPE_EXP.pion    =  picrh_ion .* 1e6;
ICRH_SHAPE_EXP.pfw     =  picrh_fw  .* 1e6;
setappdata(0,'ICRH_SHAPE_EXP',ICRH_SHAPE_EXP)

function out = fisrt

out = [
0.000	1.266e-05	3.403e-07	1.130e+00
0.005	1.268e-05	3.409e-07	1.122e+00
0.025	1.280e-05	3.446e-07	8.890e-01
0.045	1.293e-05	3.481e-07	9.173e-01
0.065	1.245e-04	4.242e-06	5.089e-01
0.085	1.078e-04	3.741e-06	3.324e-01
0.105	5.469e-05	1.843e-06	2.596e-01
0.125	1.676e-05	4.824e-07	1.939e-01
0.145	1.457e-05	4.032e-07	1.487e-01
0.165	1.385e-05	3.762e-07	1.850e-01
0.185	1.595e-04	5.601e-06	2.132e-01
0.205	9.406e-03	3.374e-04	2.249e-01
0.225	4.013e-01	1.421e-02	2.065e-01
0.245	7.866e+00	2.326e-01	1.486e-01
0.265	2.033e+01	5.807e-01	1.291e-01
0.285	7.218e+00	2.150e-01	8.734e-02
0.305	3.965e+00	1.251e-01	6.626e-02
0.325	3.364e+00	1.081e-01	6.245e-02
0.345	2.290e+00	7.621e-02	6.884e-02
0.365	1.269e+00	4.370e-02	6.186e-02
0.385	1.249e+00	4.304e-02	4.808e-02
0.405	1.474e+00	5.047e-02	4.926e-02
0.425	1.045e+00	3.628e-02	5.369e-02
0.445	5.381e-01	1.898e-02	5.359e-02
0.465	8.112e-01	2.832e-02	5.716e-02
0.485	1.045e+00	3.612e-02	5.813e-02
0.505	7.063e-01	2.454e-02	5.448e-02
0.525	9.209e-01	3.205e-02	5.399e-02
0.545	1.942e+00	6.569e-02	4.836e-02
0.565	2.273e+00	7.616e-02	4.412e-02
0.585	1.291e+00	4.453e-02	4.429e-02
0.605	3.381e-01	1.194e-02	4.210e-02
0.625	4.823e-01	1.705e-02	3.693e-02
0.645	1.111e+00	3.861e-02	3.069e-02
0.665	1.726e+00	5.893e-02	2.514e-02
0.685	1.288e+00	4.456e-02	2.299e-02
0.705	1.747e-01	6.187e-03	2.151e-02
0.725	5.110e-01	1.807e-02	2.029e-02
0.745	8.685e-01	3.046e-02	1.955e-02
0.765	3.995e-01	1.418e-02	1.594e-02
0.785	4.715e-01	1.670e-02	1.199e-02
0.805	2.719e-01	9.693e-03	1.006e-02
0.825	2.764e-01	9.865e-03	8.683e-03
0.845	8.452e-01	2.971e-02	5.754e-03
0.865	5.297e-01	1.878e-02	3.532e-03
0.885	2.780e-01	9.923e-03	2.727e-03
0.905	7.834e-01	2.763e-02	2.460e-03
0.925	7.316e-01	2.585e-02	1.399e-03
0.945	1.746e-01	6.260e-03	5.176e-04
0.965	6.004e-02	2.160e-03	7.685e-05
0.985	3.355e-01	1.198e-02	1.924e-04
1.000	0.000e+00	0.000e+00	0.000e+00];


function out = second

out = [
0.000	3.790e-05	5.174e-06	7.500e+00
0.020	9.286e-05	5.076e-06	6.534e+00
0.040	1.524e-04	8.223e-06	2.583e+00
0.060	2.651e-04	1.267e-06	2.565e+00
0.080	4.390e-04	1.576e-06	1.605e+00
0.100	1.746e-02	4.517e-05	1.115e+00
0.120	5.032e-03	1.524e-05	1.399e+00
0.140	5.867e-04	4.036e-06	1.502e+00
0.160	3.711e-04	3.222e-06	1.001e+00
0.180	5.088e-03	2.090e-04	5.908e-01
0.200	2.676e-02	1.140e-03	7.146e-01
0.220	4.489e-01	2.277e-02	8.856e-01
0.240	4.515e+00	4.659e+00	7.086e-01
0.260	7.196e+00	1.098e+01	4.630e-01
0.280	4.651e+00	5.187e+00	4.323e-01
0.300	3.480e+00	2.376e+00	4.842e-01
0.320	3.437e+00	2.334e+00	4.387e-01
0.340	2.819e+00	1.122e+00	3.480e-01
0.360	1.589e+00	1.871e-01	3.232e-01
0.380	1.314e+00	1.251e-01	3.443e-01
0.400	1.391e+00	1.418e-01	3.222e-01
0.420	9.922e-01	7.556e-02	2.702e-01
0.440	1.041e+00	8.066e-02	2.663e-01
0.460	1.766e+00	2.316e-01	2.560e-01
0.480	1.655e+00	1.806e-01	1.962e-01
0.500	9.438e-01	5.828e-02	1.699e-01
0.520	1.231e+00	1.077e-01	1.851e-01
0.540	1.712e+00	2.354e-01	1.780e-01
0.560	1.369e+00	1.374e-01	1.566e-01
0.580	8.437e-01	5.707e-02	1.473e-01
0.600	7.229e-01	4.887e-02	1.527e-01
0.620	6.557e-01	4.521e-02	1.625e-01
0.640	6.718e-01	4.665e-02	1.654e-01
0.660	7.151e-01	4.934e-02	1.593e-01
0.680	5.812e-01	3.709e-02	1.469e-01
0.700	6.683e-01	4.602e-02	1.392e-01
0.720	8.001e-01	6.135e-02	1.335e-01
0.740	5.924e-01	3.956e-02	1.334e-01
0.760	3.838e-01	2.246e-02	1.331e-01
0.780	3.800e-01	2.172e-02	1.190e-01
0.800	3.297e-01	1.860e-02	1.027e-01
0.820	2.155e-01	1.085e-02	9.157e-02
0.840	1.562e-01	7.524e-03	9.101e-02
0.860	1.725e-01	8.652e-03	8.684e-02
0.880	1.772e-01	8.545e-03	7.724e-02
0.900	1.372e-01	6.170e-03	6.308e-02
0.920	8.828e-02	3.817e-03	5.156e-02
0.940	5.473e-02	2.275e-03	4.194e-02
0.960	4.896e-02	1.757e-03	3.262e-02
0.980	6.043e-02	1.893e-03	3.602e-02
1.000	1.649e-05	5.076e-06	3.000e-03];

function out = third

out = [
0.000	8.980e-07	0.000e+00	5.149e+00
0.020	9.795e-07	0.000e+00	4.091e+00
0.040	1.034e-06	0.000e+00	4.600e+00
0.060	8.225e-05	2.189e-06	4.417e+00
0.080	1.573e-04	4.293e-06	3.658e+00
0.100	1.413e-05	3.453e-07	3.179e+00
0.120	4.215e-05	1.150e-06	3.165e+00
0.140	8.207e-04	2.376e-05	3.031e+00
0.160	6.264e-03	1.855e-04	2.491e+00
0.180	2.711e-02	8.256e-04	1.969e+00
0.200	1.776e-01	5.888e-03	1.842e+00
0.220	1.355e+00	1.126e-01	1.868e+00
0.240	3.680e+00	2.489e+00	1.749e+00
0.260	4.868e+00	4.583e+00	1.484e+00
0.280	4.035e+00	3.243e+00	1.243e+00
0.300	3.445e+00	2.271e+00	1.148e+00
0.320	3.067e+00	1.664e+00	1.190e+00
0.340	2.630e+00	1.020e+00	1.132e+00
0.360	2.313e+00	6.597e-01	9.409e-01
0.380	2.120e+00	4.954e-01	8.314e-01
0.400	2.247e+00	6.232e-01	8.500e-01
0.420	1.978e+00	4.089e-01	8.057e-01
0.440	1.051e+00	8.062e-02	6.828e-01
0.460	5.499e-01	2.924e-02	5.926e-01
0.480	5.501e-01	2.981e-02	5.602e-01
0.500	4.414e-01	2.281e-02	5.713e-01
0.520	3.828e-01	1.947e-02	5.706e-01
0.540	4.708e-01	2.560e-02	5.206e-01
0.560	6.156e-01	3.722e-02	4.633e-01
0.580	7.002e-01	4.554e-02	4.047e-01
0.600	7.260e-01	4.876e-02	3.685e-01
0.620	6.188e-01	3.901e-02	3.637e-01
0.640	3.894e-01	2.156e-02	2.882e-01
0.660	2.089e-01	1.063e-02	2.253e-01
0.680	1.354e-01	6.706e-03	2.275e-01
0.700	2.582e-01	1.364e-02	2.242e-01
0.720	3.357e-01	1.853e-02	1.983e-01
0.740	1.963e-01	1.011e-02	1.622e-01
0.760	6.230e-02	3.018e-03	1.549e-01
0.780	1.388e-01	6.942e-03	1.693e-01
0.800	3.676e-01	2.059e-02	1.768e-01
0.820	3.329e-01	1.818e-02	1.616e-01
0.840	1.490e-01	7.330e-03	1.442e-01
0.860	2.376e-01	1.209e-02	1.412e-01
0.880	3.518e-01	1.884e-02	1.304e-01
0.900	2.385e-01	1.178e-02	1.014e-01
0.920	7.939e-02	3.537e-03	7.089e-02
0.940	3.805e-02	1.620e-03	4.507e-02
0.960	1.151e-01	4.975e-03	3.317e-02
0.980	2.077e-01	9.316e-03	3.670e-02
1.000	1.048e-05	1.000e-05	1.000e-03];
