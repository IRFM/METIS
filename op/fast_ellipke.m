% fonction rapide de calcul des integrales elliptiques
function [k,e] = fast_ellipke2(m)


%  !-------------------------
%  	FUNCTION ELLIPK(X)
%  !-------------------------
%  !
%  
%          IMPLICIT double precision (A-H,O-Z)
%          IMPLICIT integer*8 (I-N)
%  
%          A0 = 1.38629436112
%  	A1 = 0.09666344259
%  	A2 = 0.03590092383
%          A3 = 0.03742563713
%  	A4 = 0.01451196212
%      
%  	B0 = 0.5
%          B1 = 0.12498593597
%  	B2 = 0.06880248576
%          B3 = 0.03328355346
%  	B4 = 0.00441787012
%  	
%          Y          = 1-X*X
%          A          = (((A4*Y+A3)*Y+A2)*Y+A1)*Y+A0
%          B          = (((B4*Y+B3)*Y+B2)*Y+B1)*Y+B0
%  	ELLIPK     = A+B*DLOG(1./Y)
%  	END function ELLIPK
%  
        A0 = 1.38629436112;
	A1 = 0.09666344259;
	A2 = 0.03590092383;
        A3 = 0.03742563713;
	A4 = 0.01451196212;
    
	B0 = 0.5;
        B1 = 0.12498593597;
	B2 = 0.06880248576;
        B3 = 0.03328355346;
	B4 = 0.00441787012;

	X = sqrt(m); %
        Y          = 1-X.*X;
        A          = (((A4.*Y+A3).*Y+A2).*Y+A1).*Y+A0;
        B          = (((B4.*Y+B3).*Y+B2).*Y+B1).*Y+B0;
  	k          = A + B .* log(1./max(eps,Y));
	k(m>=1)    = Inf;


%  !
%  !-------------------------
%  	FUNCTION ELLIPE(X)
%  !-------------------------
%  !
%   
%          IMPLICIT double precision (A-H,O-Z)
%          IMPLICIT integer*8 (I-N)
%  
%          A1 = 0.44325141463
%  	A2 = 0.06260601220
%          A3 = 0.04757383546
%  	A4 = 0.01736506451
%          
%          B1 = 0.24998368310
%  	B2 = 0.09200180037
%          B3 = 0.04069697526
%  	B4 = 0.00526449639
%  	
%          Y       = 1-X*X
%          A       = (((A4*Y+A3)*Y+A2)*Y+A1)*Y+1.
%          B       = (((B4*Y+B3)*Y+B2)*Y+B1)*Y
%  	ELLIPE  = A+B*DLOG(1./Y)
%  	END function ELLIPE
%  
        A1 = 0.44325141463;
	A2 = 0.06260601220;
        A3 = 0.04757383546;
	A4 = 0.01736506451;
        
        B1 = 0.24998368310;
	B2 = 0.09200180037;
        B3 = 0.04069697526;
	B4 = 0.00526449639;
	
        % Y       = 1-X*X
        A       = (((A4.*Y+A3).*Y+A2).*Y+A1).*Y+1;
        B       = (((B4.*Y+B3).*Y+B2).*Y+B1).*Y;
	e       = A+B.*log(1./max(eps,Y));
